# ğŸš€ æ‰‹åŠ¨ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨ 115.190.137.87 éƒ¨ç½²å‘½ä»¤

---

## ğŸ“¦ ç¬¬ä¸€æ­¥ï¼šæ‰“åŒ…éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶

### åœ¨æœ¬åœ° Windows PowerShell ä¸­æ‰§è¡Œï¼š

```powershell
# è¿›å…¥é¡¹ç›®ç›®å½•
cd C:\Users\Administrator\Desktop\AIvdeo

# åˆ›å»ºéƒ¨ç½²åŒ…ç›®å½•
New-Item -ItemType Directory -Force -Path deploy_package

# å¤åˆ¶åç«¯æ–‡ä»¶åˆ°éƒ¨ç½²åŒ…
Copy-Item backend\*.py deploy_package\
Copy-Item backend\requirements.txt deploy_package\
Copy-Item backend\start.sh deploy_package\
Copy-Item backend\setup_database.sh deploy_package\

# ç¡®ä¿ .env æ–‡ä»¶å­˜åœ¨ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼Œéœ€è¦å…ˆåˆ›å»ºï¼‰
# Copy-Item backend\.env deploy_package\
```

---

## ğŸ“¤ ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ SCP ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

### Windows PowerShell å‘½ä»¤ï¼š

```powershell
# ä¸Šä¼ æ‰€æœ‰ Python æ–‡ä»¶
scp backend\*.py root@115.190.137.87:/root/soradirector-backend/

# ä¸Šä¼ é…ç½®æ–‡ä»¶
scp backend\requirements.txt root@115.190.137.87:/root/soradirector-backend/
scp backend\start.sh root@115.190.137.87:/root/soradirector-backend/
scp backend\setup_database.sh root@115.190.137.87:/root/soradirector-backend/

# ä¸Šä¼  .env æ–‡ä»¶ï¼ˆé‡è¦ï¼ï¼‰
scp backend\.env root@115.190.137.87:/root/soradirector-backend/
```

### æˆ–è€…ä½¿ç”¨å•ä¸ªå‘½ä»¤ä¸Šä¼ æ‰€æœ‰æ–‡ä»¶ï¼š

```powershell
scp backend\*.py backend\requirements.txt backend\start.sh backend\setup_database.sh backend\.env root@115.190.137.87:/root/soradirector-backend/
```

---

## ğŸ” ç¬¬ä¸‰æ­¥ï¼šSSH è¿æ¥åˆ°æœåŠ¡å™¨

```powershell
ssh root@115.190.137.87
```

---

## ğŸ”§ ç¬¬å››æ­¥ï¼šåœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²ï¼ˆSSH ä¼šè¯ä¸­æ‰§è¡Œï¼‰

### 1. è¿›å…¥é¡¹ç›®ç›®å½•

```bash
cd /root/soradirector-backend
```

### 2. è®¾ç½®è„šæœ¬æ‰§è¡Œæƒé™

```bash
chmod +x start.sh
chmod +x setup_database.sh
```

### 3. æ£€æŸ¥ä¸Šä¼ çš„æ–‡ä»¶

```bash
ls -lh
```

### 4. å®‰è£…/æ›´æ–° Python ä¾èµ–

```bash
# ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿ
pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# æˆ–è€…ä½¿ç”¨é»˜è®¤æº
pip3 install -r requirements.txt
```

### 5. éªŒè¯ .env é…ç½®

```bash
cat .env | grep -E "(DB_HOST|DB_PORT|DB_NAME|TOS_)"
```

### 6. åˆå§‹åŒ–æ•°æ®åº“ï¼ˆå¦‚æœæ˜¯é¦–æ¬¡éƒ¨ç½²ï¼‰

```bash
python3 init_db.py
```

### 7. åœæ­¢æ—§æœåŠ¡

```bash
# æŸ¥æ‰¾å¹¶åœæ­¢ç°æœ‰çš„ uvicorn è¿›ç¨‹
pkill -f "uvicorn main:app"

# æˆ–è€…æ‰‹åŠ¨æŸ¥æ‰¾è¿›ç¨‹ID
ps aux | grep uvicorn
# ç„¶åä½¿ç”¨ kill -9 <è¿›ç¨‹ID>
```

### 8. å¯åŠ¨æ–°æœåŠ¡

#### é€‰é¡¹ Aï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
nohup ./start.sh > server.log 2>&1 &
```

#### é€‰é¡¹ Bï¼šç›´æ¥ä½¿ç”¨ uvicorn

```bash
nohup uvicorn main:app --host 0.0.0.0 --port 8000 > server.log 2>&1 &
```

#### é€‰é¡¹ Cï¼šå‰å°è¿è¡Œï¼ˆè°ƒè¯•ç”¨ï¼‰

```bash
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### 9. æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep uvicorn

# æŸ¥çœ‹æ—¥å¿—ï¼ˆå®æ—¶ï¼‰
tail -f server.log

# æŸ¥çœ‹æœ€è¿‘çš„æ—¥å¿—
tail -100 server.log
```

### 10. æµ‹è¯•æœåŠ¡

```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# æµ‹è¯• API æ–‡æ¡£
curl http://localhost:8000/docs
```

---

## ğŸŒ ç¬¬äº”æ­¥ï¼šä»æœ¬åœ°è®¿é—®æµ‹è¯•

### åœ¨æœ¬åœ° Windows PowerShell ä¸­ï¼š

```powershell
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://115.190.137.87:8000/health

# æˆ–ä½¿ç”¨æµè§ˆå™¨è®¿é—®
# http://115.190.137.87:8000
# http://115.190.137.87:8000/docs
```

---

## ğŸ”„ å¿«é€Ÿé‡æ–°éƒ¨ç½²ï¼ˆæ›´æ–°ä»£ç åï¼‰

### å®Œæ•´çš„å¿«é€Ÿéƒ¨ç½²å‘½ä»¤ç»„åˆï¼š

```powershell
# 1. æœ¬åœ°ä¸Šä¼ ï¼ˆWindows PowerShellï¼‰
cd C:\Users\Administrator\Desktop\AIvdeo
scp backend\*.py backend\requirements.txt root@115.190.137.87:/root/soradirector-backend/

# 2. SSH è¿æ¥
ssh root@115.190.137.87

# 3. æœåŠ¡å™¨é‡å¯ï¼ˆåœ¨ SSH ä¼šè¯ä¸­ï¼‰
cd /root/soradirector-backend
pkill -f "uvicorn main:app"
pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
nohup uvicorn main:app --host 0.0.0.0 --port 8000 > server.log 2>&1 &
tail -f server.log
```

---

## ğŸ“‹ ä¸€é”®éƒ¨ç½²è„šæœ¬

### åˆ›å»ºæœ¬åœ°æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆWindowsï¼‰

ä¿å­˜ä¸º `deploy.bat`ï¼š

```batch
@echo off
echo ========================================
echo æ­£åœ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ 115.190.137.87
echo ========================================

cd /d C:\Users\Administrator\Desktop\AIvdeo

echo.
echo [1/3] ä¸Šä¼  Python æ–‡ä»¶...
scp backend\*.py root@115.190.137.87:/root/soradirector-backend/

echo.
echo [2/3] ä¸Šä¼ é…ç½®æ–‡ä»¶...
scp backend\requirements.txt root@115.190.137.87:/root/soradirector-backend/

echo.
echo [3/3] è¿æ¥æœåŠ¡å™¨é‡å¯æœåŠ¡...
echo è¯·åœ¨ SSH ä¼šè¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
echo.
echo cd /root/soradirector-backend
echo pkill -f "uvicorn main:app"
echo pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
echo nohup uvicorn main:app --host 0.0.0.0 --port 8000 ^> server.log 2^>^&1 ^&
echo.

pause
ssh root@115.190.137.87
```

### ä½¿ç”¨æ–¹æ³•ï¼š

```powershell
# åŒå‡»è¿è¡Œ deploy.bat
# æˆ–åœ¨ PowerShell ä¸­æ‰§è¡Œ
.\deploy.bat
```

---

## ğŸ” å¸¸è§é—®é¢˜æ’æŸ¥

### 1. æ— æ³•è¿æ¥æœåŠ¡å™¨

```bash
# æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯è¾¾
ping 115.190.137.87

# æ£€æŸ¥ SSH ç«¯å£
telnet 115.190.137.87 22
```

### 2. ä¸Šä¼ å¤±è´¥

```bash
# ç¡®ä¿æœåŠ¡å™¨ç›®å½•å­˜åœ¨
ssh root@115.190.137.87 "mkdir -p /root/soradirector-backend"
```

### 3. æœåŠ¡å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
tail -50 server.log

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep 8000

# æ‰‹åŠ¨å¯åŠ¨æŸ¥çœ‹é”™è¯¯
cd /root/soradirector-backend
python3 main.py
```

### 4. æ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
python3 -c "from database import test_connection; test_connection()"

# æ£€æŸ¥ .env é…ç½®
cat .env
```

---

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### å®æ—¶ç›‘æ§æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
tail -f server.log

# åªçœ‹é”™è¯¯æ—¥å¿—
tail -f server.log | grep ERROR

# åªçœ‹æ•°æ®åº“ç›¸å…³æ—¥å¿—
tail -f server.log | grep DATABASE
```

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep uvicorn

# æŸ¥çœ‹ç«¯å£ç›‘å¬
netstat -tlnp | grep 8000

# æŸ¥çœ‹æœ€è¿‘çš„è®¿é—®
tail -100 server.log | grep "GET\|POST"
```

---

## ğŸ¯ å®Œæ•´éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] âœ… æ‰€æœ‰ Python æ–‡ä»¶å·²ä¸Šä¼ 
- [ ] âœ… requirements.txt å·²ä¸Šä¼ 
- [ ] âœ… .env é…ç½®æ–‡ä»¶å·²ä¸Šä¼ 
- [ ] âœ… è„šæœ¬æ–‡ä»¶å·²è®¾ç½®æ‰§è¡Œæƒé™
- [ ] âœ… Python ä¾èµ–å·²å®‰è£…
- [ ] âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] âœ… æ—§æœåŠ¡å·²åœæ­¢
- [ ] âœ… æ–°æœåŠ¡å·²å¯åŠ¨
- [ ] âœ… æœåŠ¡æ—¥å¿—æ­£å¸¸
- [ ] âœ… API æµ‹è¯•é€šè¿‡
- [ ] âœ… ä»å¤–ç½‘å¯ä»¥è®¿é—®

---

## ğŸš€ åç»­ä¼˜åŒ–å»ºè®®

### 1. ä½¿ç”¨ Git éƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
cd /root/soradirector-backend
git pull origin main
pip3 install -r requirements.txt
pkill -f "uvicorn main:app"
nohup uvicorn main:app --host 0.0.0.0 --port 8000 > server.log 2>&1 &
```

### 2. ä½¿ç”¨è¿›ç¨‹ç®¡ç†å™¨ï¼ˆæ¨èï¼‰

```bash
# å®‰è£… supervisor
pip3 install supervisor

# æˆ–ä½¿ç”¨ systemd æœåŠ¡
```

### 3. ä½¿ç”¨ Nginx åå‘ä»£ç†

```bash
# é…ç½® Nginx ä½œä¸ºåå‘ä»£ç†
# æä¾› HTTPS æ”¯æŒ
```

---

**éƒ¨ç½²å®Œæˆï¼** ğŸ‰

æœ‰ä»»ä½•é—®é¢˜éšæ—¶å‘Šè¯‰æˆ‘ï¼
